---
title: "Scratchpad"
output: html_notebook
---

*NOTES FROM 6/30 meeting*

Outcomes to analyze:
1. Any self-cancelled appts - Any_Self_Cancelled_Appt
2. Any self-cancelled screenings - Combination of adh_cancer_test_T1 and adh_cancer_test_who_T1
3. Likelihood of getting suspicious symptom checked out (Likert) - adh_cancer_sx_T1
4. Number of missed endocrine therapy doses - et_missed
4b. compare change in amount missed at T1 of Covid to last REACH timepoint, for REACH participants
5. Binge drinking (score as Yes/No?) - Any_Self_Cancelled_Appt
6. Cannabis use - ?
7. Exercise - continuous variable? Create variable capturing whether individuals met CDC cutoffs?


*NOTES FROM 7/7/21 meeting*
We may be able to examine mediation with variables with just 14ish observations of TRUE

Potential mediators:
- Approach-oriented coping/ EAC
- Avoidance-oriented coping
- Anxiety symptoms: This could go either way re: keeping vs. cancelling appointments 
- Depression symptoms
- Intolerance of uncertainty (3 items)
- Loneliness (3 items)
- Valuing questionnaire, i.e., meaning and purpose in life
- Financial impacts of covid (YES/NO)


*Notes from 7/19 meeting*

Potential "X" variables:
- COVID fear-overall
- COVID cancer survivor-specific fear

We could look at both of these variables separately as "X" variables given that we saw they were differentiable in the previous Slivjak et al 2021 paper, AND because we are interested in cancer-specific behaviors.

Potential mediators:
- Depression sx
- Approach coping
- Avoidance coping
- Anxiety

We will proceed with single mediation models first, then combine significant mediators in those models into a multiple mediation model. BUT, we expect potential collinearity issues with depression and anxiety in the model simultaneously given their high correlation.

OUTCOMES:
i.	Patient-cancelled any appointment (including cancer screening appointments)  Variable: Any_Self_Cancelled_Appt_T1
ii.	patient-cancelled cancer screening at T1 (=15) (T2=7, T3=3); Variable: TBMade (Joel); binary outcome
iii.	Would delay in seeking medical care for a suspicious symptom (T1=18, T2=14, T3=7 so maybe limit to T1 and T2) Variable: adh_cancer_sx_T1; binary outcome - requires some work?



```{r}
library(tidyverse)
library(here)
library(lme4)
library(pander)
library(lavaan)
library(jtools)

main_data <- read_csv(file = '~/Research - Lives on HD/Covid Canceled Medical Appointments Analysis/Raw Data/COVID Main Database All_06-17-21.csv')

missed_appts <- readRDS(file = '~/Research - Lives on HD/Covid Canceled Medical Appointments Analysis/Generated Data/any_self_or_provider_cancelled_appts.rds')
                        
data <- left_join(main_data, missed_appts, by = "record_id")
```


```{r}
table(data$Any_Self_Cancelled_Appt_T1)


```


```{r}

my.model <- '

Any_Self_Cancelled_Appt_T1 ~ 
gad7_mean_T1


'

model.fit.categorical <- lavaan::sem(model = my.model, ,
                                     ordered = c('Any_Self_Cancelled_Appt_T1'),
                                      
                         data = data)

summary(model.fit.categorical)


```


```{r}

summ(glm(Any_Self_Cancelled_Appt_T1 ~ 1,data = data))


summ(glm(Any_Self_Cancelled_Appt_T1 ~ gad7_mean_T1, data = data))


```


```{r}

cbind(data$Any_Self_Cancelled_Appt_T1, 
      data$Any_Self_Cancelled_Appt_T2, 
      data$Any_Self_Cancelled_Appt_T1 == data$Any_Self_Cancelled_Appt_T2) %>%
  View()

```

# Individual changes in cancellation behavior

Cancelled at T1 and T2 = 32 individuals

Cancelled at T1 but not at T2 = 17 individuals

```{r}
data %>%
  filter(Any_Self_Cancelled_Appt_T1 == TRUE) %>%
  filter(Any_Self_Cancelled_Appt_T2 == FALSE)


data %>%
  filter(Any_Self_Cancelled_Appt_T1 == TRUE) %>%
  filter(Any_Self_Cancelled_Appt_T2 == TRUE) 



```


# Mediation - coverage of mediators by true/false variables

```{r}

data %>%
  group_by(Any_Self_Cancelled_Appt_T1) %>%
  summarise(n = sum(!is.na(gad7_mean_T1)),
            mean_gad = round(mean(gad7_mean_T1, na.rm=TRUE),2),
            sd_gad = round(sd(gad7_mean_T1, na.rm=TRUE),2))

```

```{r}

data %>%
  

```
